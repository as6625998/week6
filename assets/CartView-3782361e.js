import{_ as I,r as b,o as h,c as p,a as g,d as e,F as v,f as V,g as k,t as r,b as d,w as P,h as C,v as E,n as f,i as U}from"./index-70f2d5ee.js";const{VITE_APP_URL:i,VITE_APP_PATH:c}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"koung-hexschool",BASE_URL:"/week6/",MODE:"production",DEV:!1,PROD:!0},A={data(){return{products:[],productId:"",cart:{},loadingItem:"",form:{user:{name:"",email:"",tel:"",address:""}},message:""}},methods:{getCarts(){this.$http.get(`${i}/v2/api/${c}/cart`).then(t=>{console.log("購物車:",t.data.data),this.cart=t.data.data}).catch(t=>{alert(t.res.data.message)})},updataCartItem(t){const s={product_id:t.product.id,qty:t.qty};this.loadingItem=t.id,this.$http.put(`${i}/v2/api/${c}/cart/${t.id}`,{data:s}).then(n=>{console.log("更新購物車:",n.data),this.getCarts(),this.loadingItem=""})},deleteItem(t){this.loadingItem=t.id,this.$http.delete(`${i}/v2/api/${c}/cart/${t.id}`).then(s=>{console.log("刪除購物車:",s.data),alert(s.data.message),this.getCarts(),this.loadingItem=""})},deleteAllCarts(){this.$http.delete(`${i}/v2/api/${c}/carts`).then(t=>{alert(t.data.message),this.getCarts()}).catch(t=>{alert(t.res.data.message)})},createOrder(){const t=`${i}/v2/api/${c}/order`,s=this.form;this.$http.post(t,{data:s}).then(n=>{alert(n.data.message),this.$refs.form.resetForm(),this.getCarts()}).catch(n=>{alert(n.response.data.message)})}},mounted(){this.getCarts()}},q={class:"text-end"},w=["disabled"],T={class:"table align-middle"},D=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",null,"單價")])],-1),S=["disabled","onClick"],B=e("div",{class:"text-success"}," 已套用優惠券 ",-1),L={class:"input-group input-group-sm"},N={class:"input-group mb-3"},O=["onUpdate:modelValue","disabled","onChange"],R=["value"],$={class:"text-end"},F=e("small",{class:"text-success"},"折扣價：",-1),M=e("td",{colspan:"3",class:"text-end"},"總計",-1),H={class:"text-end"},j=e("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),z={class:"text-end text-success"},G={class:"my-5 row justify-content-center"},J={class:"mb-3"},K=e("label",{for:"email",class:"form-label"},"Email",-1),Q={class:"mb-3"},W=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),X={class:"mb-3"},Y=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),Z={class:"mb-3"},ee=e("label",{for:"address",class:"form-label"},"收件人地址",-1),te={class:"mb-3"},se=e("label",{for:"message",class:"form-label"},"留言",-1),le=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1);function ae(t,s,n,oe,l,m){var x;const u=b("v-field"),_=b("error-message"),y=b("v-form");return h(),p(v,null,[g(" 這是購物車 "),e("div",q,[e("button",{class:"btn btn-outline-danger",type:"button",onClick:s[0]||(s[0]=o=>m.deleteAllCarts()),disabled:((x=l.cart.carts)==null?void 0:x.length)===0},"清空購物車",8,w)]),e("table",T,[D,e("tbody",null,[l.cart.carts?(h(!0),p(v,{key:0},V(l.cart.carts,o=>(h(),p("tr",{key:o.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:o.id===l.loadingItem,onClick:a=>m.deleteItem(o)}," x ",8,S)]),e("td",null,[g(r(o.product.title)+" ",1),B]),e("td",null,[e("div",L,[e("div",N,[C(e("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":a=>o.qty=a,disabled:o.id===l.loadingItem,onChange:a=>m.updataCartItem(o)},[(h(),p(v,null,V(20,a=>e("option",{value:a,key:a+12345},r(a),9,R)),64))],40,O),[[E,o.qty]])])])]),e("td",$,[F,g(" "+r(o.final_total),1)])]))),128)):k("",!0)]),e("tfoot",null,[e("tr",null,[M,e("td",H,r(l.cart.total),1)]),e("tr",null,[j,e("td",z,r(l.cart.final_total),1)])])]),e("div",G,[d(y,{ref:"form",class:"col-md-6",onSubmit:m.createOrder},{default:P(({errors:o})=>[e("div",J,[K,d(u,{id:"email",name:"email",type:"email",class:f(["form-control",{"is-invalid":o.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=a=>l.form.user.email=a)},null,8,["class","modelValue"]),d(_,{name:"email",class:"invalid-feedback"})]),e("div",Q,[W,d(u,{id:"name",name:"姓名",type:"text",class:f(["form-control",{"is-invalid":o.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":s[2]||(s[2]=a=>l.form.user.name=a)},null,8,["class","modelValue"]),d(_,{name:"姓名",class:"invalid-feedback"})]),e("div",X,[Y,d(u,{id:"tel",name:"電話",type:"text",class:f(["form-control",{"is-invalid":o.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:l.form.user.tel,"onUpdate:modelValue":s[3]||(s[3]=a=>l.form.user.tel=a)},null,8,["class","modelValue"]),d(_,{name:"電話",class:"invalid-feedback"})]),e("div",Z,[ee,d(u,{id:"address",name:"地址",type:"text",class:f(["form-control",{"is-invalid":o.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":s[4]||(s[4]=a=>l.form.user.address=a)},null,8,["class","modelValue"]),d(_,{name:"地址",class:"invalid-feedback"})]),e("div",te,[se,C(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[5]||(s[5]=a=>l.form.message=a)},null,512),[[U,l.form.message]])]),le]),_:1},8,["onSubmit"])])],64)}const ne=I(A,[["render",ae]]);export{ne as default};
